<!-- Helper Element for friends-page Element -->
<link rel='import' href='../../bower_components/polymer/polymer.html'>

<dom-module id='friend-classes'>
  <template>
    <iron-ajax
      id='classLoader'
      url='[[targetURL]]'
      headers='{{_makeHeaders()}}'
      handle-as='json'
      last-response='{{friendClasses}}'>
    </iron-ajax>
    <ul>
    <template is='dom-repeat' items='[[friendClasses.replyObject]]'>
      <li>[[item]]</li>
    </template>
    <ul>
  </template>
  <script>
  (function() {
    'use strict';
    Polymer({
      is: 'friend-classes',
      _makeHeaders: function() {
        return document.getTokenHeader();
      },
      _getSelfRIN: function() {
        return document.getRIN();
      },
      _getAjaxParams: function() {
        var params = { 
          friendRIN: this.friendRIN,
          RIN: document.getRIN()
        };
        console.log('Sending AJAX params', params);
        return params;
      },
      go: function() {
        var loader = this.$.classLoader;
        loader.params = {};
        loader.params.friendRIN = this.friendRIN;
        loader.params.RIN = document.getRIN();
        console.log('Loading friend classes with',loader);
        loader.generateRequest();
        console.log('Fired request');
      },
      properties: {
        _selfRIN: {
          type: String,
          computed: '_getSelfRIN()'
        },
        friendRIN: {
          type: String,
          notify: true
        },
        targetURL: {
          type: String,
          notify: true
        },
        friendClasses: {
          type: Object,
          notify: true,
          value: {replyObject:['loading...']}
        }
      }
    });
  })();
  </script>
</dom-module>
